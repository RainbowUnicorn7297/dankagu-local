import grpc

from takasho.packer import packer
from takasho.schema.common_featureset.player_api import player_storage_pb2


if __name__ == '__main__':
    # Debug packer
    # print(bytes.hex(packer.unpack(bytes.fromhex('860a1c68b9e792a180f17ecb700da9eb3f85d531e021f012089820b41840ef86cc6280e2692dd15844c6d699ad49d97c5229e04c4e20ea3d87f446119e5f3ee8831456e0b6eb2ad162e367765d657f622f7f36d8a41b4d0f6536aa49ad8d771e1b7b319f597a6754a4d70293e35a8dbd9ddbce933efecb9597a07aec188a347b4158f20779efba6d7c64b76d0532d8d97de20bdd309faba625569b1e5796c0a9331314eb6e6c8ded78364ecd1dbdc444d90b6b8ee7482f1fc86bfa526644b47836977566dabd8df4d1cb22680102148e7891541243f67035b3a139b2a845940a5d13e04636f2a4f8ad99267ed0db0742737a68a65795f1f939ac4f5256f4f051698ef681511cacf8c721b1ffe17e0e6c59f7f697baf3b0253ca68ed80763270c9dca06b7a6533d03f2b8d45f1a2c31c52e54e913aee515ed85e23313a802c3e3a13bfa05a3876bc8c775e23e4f0aebc0306d6bb1743da29ff028e5156aacb8d45d8929d8829798d400a1dcaf286e1f8f57496dc7e9e36bd310301dc36db5fb3f0166744c6283b637b7e75e3dc734ae3469806c1381486f618b621ace46f6f6916b7884b1fe07078bd22d9365f25aa34b8ce4bd48210ce528d55cbde6cdb2b46cccf174a50dc12b7b37c76ee3aa4e7a798096ce70c84b035c447080916eba77a23bca'))))
    # Debug gRPC message
    # print(player_preference_pb2.PlayerPreferenceGetPreferenceV1.Response.FromString(packer.unpack(bytes.fromhex('5e690f0c768ed8685e3be537a71574345306908970198d3f417f3c9690e2c939f96da8ed625fe2353e5ff7be05537f43eb0f7198748b13b24c8b849fe4ae734ae09815422f4986a5e3c837f311f32baffdcff8c4e17ffe8e9594a139b91bbd2d53e920ccf6f735414544'))))
    response = player_storage_pb2.PlayerStorageGetEntriesV2.Response.FromString(packer.unpack(bytes.fromhex('d605708b66d809b276bf8fa0dfee542542d347695e33794efa95f2d096d76ed9f9285450083b0e3527e3110600914162d12e33f311f3132609cd26cbbb7a33475ff7b2abad9b05674f7881d95d144ef8db38dfcc8083dbfeb9fc57f963c2410ab03febe281c6cebaaf79fcd005d8a782cda706783c961140dc17b767e0b7c615c33441fd93a19891bfb78739b21f7ac45492ea47d91988b8816fb852dc1b43717bd0a8bd98a347db72dc3555a08d0f80cad1fd6c951dda715e8440495e16')))
    print(response)
    for entry in response.entries:
        print(bytes.hex(entry.value))

